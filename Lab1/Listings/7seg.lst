


ARM Macro Assembler    Page 1 


    1 00000000         ; Desenvolvido para a placa EK-TM4C129EXL
    2 00000000         ; Matheus Passos, Lucas Yukio, Jo√£o Castilho Cardoso
    3 00000000         ; 24/08/2020
    4 00000000         ; Contagem de 0 a 99 nos displays de 7 segmentos, passo 
                       ajust√°vel por USR_SW1, modo invers√£o por USR_SW2
    5 00000000         
    6 00000000         ; ------------------------------------------------------
                       -------------------------
    7 00000000                 THUMB                        ; InstruÔøΩÔøΩes do
                                                             tipo Thumb-2
    8 00000000         ; ------------------------------------------------------
                       -------------------------
    9 00000000         
   10 00000000         ;-------------------------------------------------------
                       ----------
   11 00000000         ; DEFINES
   12 00000000         ;-------------------------------------------------------
                       ----------
   13 00000000         
   14 00000000         ; M√°scaras dos transistores Q1/Q2 em PB4/PB5
   15 00000000 00000010 
                       TRANSISTOR_Q1
                               EQU              0x10        ; PB4 (unidade)
   16 00000000 00000020 
                       TRANSISTOR_Q2
                               EQU              0x20        ; PB5 (dezena)
   17 00000000         
   18 00000000         ;-------------------------------------------------------
                       ----------
   19 00000000         ; VARI√ÅVEIS EM REGISTRADORES
   20 00000000         ; R4 = contador (0-99)
   21 00000000         ; R5 = passo     (1-9)
   22 00000000         ; R6 = modo      (0=crescente,1=decrescente)
   23 00000000         ;-------------------------------------------------------
                       ----------
   24 00000000         ; ------------------------------------------------------
                       -------------------------
   25 00000000         ; ÔøΩrea de CÔøΩdigo - Tudo abaixo da diretiva a seguir 
                       serÔøΩ armazenado na memÔøΩria de 
   26 00000000         ;                  cÔøΩdigo
   27 00000000                 AREA             |.text|, CODE, READONLY, ALIGN=
2
   28 00000000         
   29 00000000         ; Se alguma funÔøΩÔøΩo do arquivo for chamada em outro a
                       rquivo 
   30 00000000                 EXPORT           Seg_Display ; Permite chamar a 
                                                            funÔøΩÔøΩo Start a 
                                                            partir de 
   31 00000000         ; outro arquivo. No caso startup.s
   32 00000000         
   33 00000000         ; Se chamar alguma funÔøΩÔøΩo externa 
   34 00000000         ;IMPORT <func>              ; Permite chamar dentro dest
                       e arquivo uma 
   35 00000000         ; funÔøΩÔøΩo <func>
   36 00000000                 IMPORT           PLL_Init
   37 00000000                 IMPORT           SysTick_Init
   38 00000000                 IMPORT           SysTick_Wait1ms
   39 00000000                 IMPORT           SysTick_Wait1us
   40 00000000                 IMPORT           GPIO_Init



ARM Macro Assembler    Page 2 


   41 00000000                 IMPORT           PortA_Output
   42 00000000                 IMPORT           PortB_Output
   43 00000000                 IMPORT           PortQ_Output
   44 00000000                 IMPORT           D7SEG_TABELA
   45 00000000         
   46 00000000         ; ------------------------------------------------------
                       -------------------------
   47 00000000         ; R0 -> dados tempor√°rios para serem enviados p/ port
   48 00000000         ; R1 -> armazena unidade temporariamente
   49 00000000         ; R2 -> armazena dezena temporariamente
   50 00000000         ; R3 -> valor da unidade de 0 a 9, para decodifica√ß√£o 
                       em formato de segmento
   51 00000000         ; R4 -> unidade no padr√£o de segmento
   52 00000000         ; R5 -> dezena no padr√£o de segmento
   53 00000000         ; R6 -> armazena endere√ßo da tabela de 7seg
   54 00000000         ;-------------------------------------------------------
                       
   55 00000000         ; Fun√ß√£o Seg_Display
   56 00000000         ;-------------------------------------------------------
                       
   57 00000000         
   58 00000000         
   59 00000000         
   60 00000000         ; ------------------------------------------------------
                       -----------
   61 00000000         Seg_Display
   62 00000000 B57E            PUSH             {R1-R6, LR}
   63 00000002 4604            MOV              R4, R0      ; ‚Üê pega o valor 
                                                            passado em R0 como 
                                                            contador
   64 00000004         
   65 00000004         ;--- separa dezena e unidade a partir de R4 ---
   66 00000004 4620            MOV              R0, R4      ; R0 = contador (0‚
                                                            Äì99)
   67 00000006 F04F 010A       MOV              R1, #10
   68 0000000A FBB0 F2F1       UDIV             R2, R0, R1  ; R2 = dezena
   69 0000000E FB02 0311       MLS              R3, R2, R1, R0 ; R3 = unidade
   70 00000012         
   71 00000012 4E1B            LDR              R6, =D7SEG_TABELA
   72 00000014         
   73 00000014         ;--- exibe a DEZENA (Q2) ---   
   74 00000014 5CB5            LDRB             R5, [R6, R2] ; R5 = padr√£o seg
                                                            mentos da dezena
   75 00000016         
   76 00000016 F005 00F0       AND              R0, R5, #0xF0 ; isola bits PA7‚
                                                            ÄìPA4
   77 0000001A F7FF FFFE       BL               PortA_Output
   78 0000001E         
   79 0000001E F005 000F       AND              R0, R5, #0x0F ; isola bits PQ3‚
                                                            ÄìPQ0
   80 00000022 F7FF FFFE       BL               PortQ_Output
   81 00000026         
   82 00000026 F04F 0020       MOV              R0, #TRANSISTOR_Q2
   83 0000002A F7FF FFFE       BL               PortB_Output ; liga Q2
   84 0000002E F04F 0001       MOV              R0, #1
   85 00000032 F7FF FFFE       BL               SysTick_Wait1ms
   86 00000036 F04F 0000       MOV              R0, #0
   87 0000003A F7FF FFFE       BL               PortB_Output ; desliga Q2
   88 0000003E F04F 0001       MOV              R0, #1



ARM Macro Assembler    Page 3 


   89 00000042 F7FF FFFE       BL               SysTick_Wait1ms
   90 00000046         
   91 00000046         ;--- exibe a UNIDADE (Q1) ---
   92 00000046 5CF5            LDRB             R5, [R6, R3] ; R5 = padr√£o seg
                                                            mentos da unidade
   93 00000048         
   94 00000048 F005 00F0       AND              R0, R5, #0xF0
   95 0000004C F7FF FFFE       BL               PortA_Output
   96 00000050         
   97 00000050 F005 000F       AND              R0, R5, #0x0F
   98 00000054 F7FF FFFE       BL               PortQ_Output
   99 00000058         
  100 00000058 F04F 0010       MOV              R0, #TRANSISTOR_Q1
  101 0000005C F7FF FFFE       BL               PortB_Output ; liga Q1
  102 00000060 F04F 0001       MOV              R0, #1
  103 00000064 F7FF FFFE       BL               SysTick_Wait1ms
  104 00000068 F04F 0000       MOV              R0, #0
  105 0000006C F7FF FFFE       BL               PortB_Output ; desliga Q1
  106 00000070 F04F 0001       MOV              R0, #1
  107 00000074 F7FF FFFE       BL               SysTick_Wait1ms
  108 00000078         
  109 00000078 E8BD 407E       POP              {R1-R6, LR}
  110 0000007C 4770            BX               LR
  111 0000007E         
  112 0000007E 00 00           ALIGN                        ; garante que o fim
                                                             da seÔøΩÔøΩo estÔø
                                                            Ω alinhada 
  113 00000080                 END                          ; fim do arquivo
              00000000 
Command Line: --debug --xref --diag_suppress=9931,A1950W --cpu=Cortex-M4.fp.sp 
--depend=.\objects\7seg.d -o.\objects\7seg.o -IC:\Users\lucas\AppData\Local\arm
\packs\Keil\TM4C_DFP\1.1.0\Device\Include\TM4C129 --predefine="__EVAL SETA 1" -
-predefine="__UVISION_VERSION SETA 542" --predefine="TM4C129ENCPDT SETA 1" --li
st=.\listings\7seg.lst 7seg.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 27 in file 7seg.s
   Uses
      None
Comment: .text unused
Seg_Display 00000000

Symbol: Seg_Display
   Definitions
      At line 61 in file 7seg.s
   Uses
      At line 30 in file 7seg.s
Comment: Seg_Display used once
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

TRANSISTOR_Q1 00000010

Symbol: TRANSISTOR_Q1
   Definitions
      At line 15 in file 7seg.s
   Uses
      At line 100 in file 7seg.s
Comment: TRANSISTOR_Q1 used once
TRANSISTOR_Q2 00000020

Symbol: TRANSISTOR_Q2
   Definitions
      At line 16 in file 7seg.s
   Uses
      At line 82 in file 7seg.s
Comment: TRANSISTOR_Q2 used once
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

D7SEG_TABELA 00000000

Symbol: D7SEG_TABELA
   Definitions
      At line 44 in file 7seg.s
   Uses
      At line 71 in file 7seg.s
Comment: D7SEG_TABELA used once
GPIO_Init 00000000

Symbol: GPIO_Init
   Definitions
      At line 40 in file 7seg.s
   Uses
      None
Comment: GPIO_Init unused
PLL_Init 00000000

Symbol: PLL_Init
   Definitions
      At line 36 in file 7seg.s
   Uses
      None
Comment: PLL_Init unused
PortA_Output 00000000

Symbol: PortA_Output
   Definitions
      At line 41 in file 7seg.s
   Uses
      At line 77 in file 7seg.s
      At line 95 in file 7seg.s

PortB_Output 00000000

Symbol: PortB_Output
   Definitions
      At line 42 in file 7seg.s
   Uses
      At line 83 in file 7seg.s
      At line 87 in file 7seg.s
      At line 101 in file 7seg.s
      At line 105 in file 7seg.s

PortQ_Output 00000000

Symbol: PortQ_Output
   Definitions
      At line 43 in file 7seg.s
   Uses
      At line 80 in file 7seg.s
      At line 98 in file 7seg.s

SysTick_Init 00000000

Symbol: SysTick_Init
   Definitions
      At line 37 in file 7seg.s
   Uses



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols

      None
Comment: SysTick_Init unused
SysTick_Wait1ms 00000000

Symbol: SysTick_Wait1ms
   Definitions
      At line 38 in file 7seg.s
   Uses
      At line 85 in file 7seg.s
      At line 89 in file 7seg.s
      At line 103 in file 7seg.s
      At line 107 in file 7seg.s

SysTick_Wait1us 00000000

Symbol: SysTick_Wait1us
   Definitions
      At line 39 in file 7seg.s
   Uses
      None
Comment: SysTick_Wait1us unused
9 symbols
349 symbols in table
